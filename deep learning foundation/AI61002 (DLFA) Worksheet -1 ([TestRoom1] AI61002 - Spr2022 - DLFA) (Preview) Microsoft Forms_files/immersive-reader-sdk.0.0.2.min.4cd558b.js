!function (e, t) { "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == typeof exports ? exports.ImmersiveReader = t() : e.ImmersiveReader = t() }(window, (function () { return function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var i = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(i.exports, i, i.exports, n), i.l = !0, i.exports } return n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) n.d(r, i, function (t) { return e[t] }.bind(null, i)); return r }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 0) }([function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1); t.renderButtons = r.renderButtons; var i = n(2); t.close = i.close, t.launchAsync = i.launchAsync }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = "data-button-style", i = "data-locale", a = "https://contentstorage.onenote.office.net/onenoteltir/permanent-static-resources/immersive-reader-icon.svg", o = { af: "Indompelende leser", am: "በህያው ስሜት ፈጣሪ ዕይታ አንባቢ", ar: "القارئ الشامل", as: "ইমাৰচিভ ৰিডাৰ", az: "İmmersiv Oxuyucu", be: "Імерсіўны чытальнік", bg: "Концентриран четец", bn: "মনোগ্রাহী পাঠক", "bn-bd": "ইমার্সিভ পাঠক", bs: "Koncentrirani čitalac", ca: "Lector immersiu", cs: "Asistivní čtečka", "cy-gb": "Darllenydd Ymdrwythol", da: "Forenklet læser", de: "Plastischer Reader", el: "Προηγμένο πρόγραμμα ανάγνωσης", en: "Immersive Reader", es: "Lector inmersivo", et: "Süvaluger", eu: "Irakurgailu murgiltzailea", fa: "خواننده همه‌جانبه", fi: "Syventävä lukuohjelma", fil: "Immersive Reader", fr: "Lecteur immersif", "ga-ie": "Léitheoir tumthach", gd: "An leughadair ùr-nòsach", gl: "Lector avanzado", gu: "ઇમર્સિવ રીડર", ha: "Mai karatu Mai barbazawa", he: "תצוגת קריאה מודרנית", hi: "इमर्सिव रीडर", hr: "Stopljeni čitač", hu: "Modern olvasó", hy: "Խորասուզված ընթերցիչ", id: "Pembaca Imersif", ig: "Ọgụụ Kenzipụtara", is: "Aðgengilegt lestrarumhverfi", it: "Strumento di lettura immersiva", ja: "イマーシブ リーダー", ka: "იმერსიული წამკითხველი", kk: "Иммерсивті оқу құралы", km: "កម្មវិធីអានពណ៌រំលេចនៅលើអេក្រង់", kn: "ಇಮ್ಮರ್ಸಿವ್ ಓದುಗ", ko: "몰입형 리더", kok: "तंद्री लागिल्लो वाचक", "ku-arab": "خوێنەری پڕ", ky: "Курчаган Окугуч", lb: "Immersive Reader", lo: "ຕົວອ່ານອິມເມີສີບ", lt: "Įtraukianti skaitytuvė", lv: "Tīrskata lasītājs", mi: "Pūpānui Rumaki", mk: "Сеопфатен читач", ml: "ഇമ്മേഴ്‌സീവ് റീഡർ", mn: "Идэвхтэй уншигч", mr: "इमर्सिव्ह वाचक", ms: "Pembaca Imersif", mt: "Qarrej Immersiv", ne: "इमेर्सिभ रिडर", nl: "Insluitende lezer", "nn-no": "Engasjerande lesar", no: "Engasjerende leser", nso: "Go Bala ka Mongwalo o Mokoto", or: "ଇମରସିଭ୍ ରିଡର୍", pa: "ਇਮਰਸਿਵ ਰੀਡਰ", "pa-arab": "گھیرن آلا مطالعہ کار", pl: "Czytnik immersyjny", prs: "خواننده نمایش", pt: "Leitura Avançada", quc: "Nim ucholajil sik'inel uwach", quz: "Wankisqa Ñawiq", ro: "Immersive Reader", ru: "Иммерсивное средство чтения", rw: "Insakazasoma", sd: "امرسو ريڊر", si: "ගිලෙන සුළු කියවනය", sk: "Imerzná čítačka", sl: "Potopni bralnik", sq: "Lexuesi kredhës", "sr-cyrl-ba": "Концентрисани читалац", "sr-cyrl-rs": "Концентрисани читалац", "sr-latn-rs": "Koncentrisani čitalac", sv: "Avancerad läsare", sw: "Kisomaji cha Kuzamisha", ta: "அற்புதமான ரீடர்", te: "మంత్రముగ్ధులను చేసే పఠన సాధనం", "tg-cyrl-tj": "Хонандаи фарогир", th: "โปรแกรมช่วยอ่าน", ti: "ኣንባቢ ሕሉው ስምዒት ፈጣሪ", tk: "Giňişleýin okaýjy", tn: "Sebadi sa Imesife", tr: "Tam Ekran Okuyucu", tt: "Чолгап алучы уку чарасы", "ug-cn": "چۆكمە ئوقۇغۇچ", uk: "Занурення в текст", ur: "امرسیو مطالعہ کار", uz: "Immersiv mutolaa vositasi", vi: "Trình đọc Chân thực", wo: "Jàngukaay bu Rafet", xh: "Isifundi Esikhulu", yo: "Ìwò Alámùtán", zh: "沉浸式阅读器", "zh-hant": "沈浸式閱讀程式", zu: "Isifundi Sokuzizwisa" }; function s(e) { var t = document.createElement("img"); t.src = a, t.style.verticalAlign = "middle"; var n = l(e.getAttribute(i) || "en"); t.alt = n, t.title = n, e.appendChild(t) } function u(e) { var t = document.createElement("span"); t.style.marginLeft = "8px", e.appendChild(t) } function d(e) { var t = document.createElement("span"), n = e.getAttribute(i) || "en"; t.textContent = l(n), e.appendChild(t) } function l(e) { return e = e.toLowerCase(), o[e] ? o[e] : "zh-hk" === e || "zh-mo" === e || "zh-tw" === e ? o["zh-hant"] : (e = e.substring(0, e.lastIndexOf("-")), o[e] ? o[e] : (e = e.substring(0, e.lastIndexOf("-")), o[e] ? o[e] : o.en)) } t.renderButtons = function (e) { var t = document.createElement("style"); t.innerHTML = ".immersive-reader-button{cursor:pointer;} .immersive-reader-button:hover{border-radius:2px", document.head.appendChild(t); var n = [].slice.call(document.getElementsByClassName("immersive-reader-button")); e && e.elements && (n = e.elements); for (var a = 0, o = n; a < o.length; a++) { var c = o[a]; c.setAttribute("type", "button"), c.setAttribute("role", "button"); var m = c.getAttribute(i) || "en"; switch (c.setAttribute("aria-label", l(m)), c.getAttribute(r) || "icon") { case "icon": s(c); break; case "text": d(c); break; case "iconAndText": s(c), u(c), d(c) } } } }, function (e, t, n) { "use strict"; var r = this && this.__assign || function () { return (r = Object.assign || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var i in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]); return e }).apply(this, arguments) }; Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(3), a = "js", o = "0.0.3"; function s(e) { if (!e) return !0; return new RegExp("^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])$").test(e) } t.launchAsync = function (e, t, n, u) { return new Promise((function (d, l) { if (e) if (n) if (n.chunks) if (n.chunks.length) if (s(t)) { var c = Date.now(); (u = r({ uiZIndex: 1e3, timeout: 15e3, useWebview: !1, allowFullscreen: !0, hideExitButton: !1 }, u)).uiZIndex && "number" == typeof u.uiZIndex || (u.uiZIndex = 1e3); var m = null, f = document.createElement("div"), v = u.useWebview ? document.createElement("webview") : document.createElement("iframe"), p = document.createElement("style"); p.innerHTML = "body{height:100%;overflow:hidden;}"; var h = function () { m && (window.clearTimeout(m), m = null) }, g = function () { document.body.contains(f) && document.body.removeChild(f), h(), p.parentNode && p.parentNode.removeChild(p) }; g(); var b = function (r) { if (r && r.data) if ("ImmersiveReader-Exit" === r.data) g(), window.removeEventListener("message", b), u.onExit && u.onExit(); else if ("ImmersiveReader-ReadyForContent" === r.data) { var a = { cogSvcsAccessToken: e, cogSvcsSubdomain: t, request: n, launchToPostMessageSentDurationInMs: Date.now() - c }; v.contentWindow.postMessage(JSON.stringify({ messageType: "Content", messageValue: a }), "*") } else "ImmersiveReader-LaunchSuccessful" === r.data ? (h(), d(f)) : "ImmersiveReader-TokenExpired" === r.data ? (g(), l({ code: i.ErrorCode.TokenExpired, message: "The access token supplied is expired." })) : "ImmersiveReader-Throttled" === r.data ? (g(), l({ code: i.ErrorCode.Throttled, message: "You have exceeded your quota." })) : "ImmersiveReader-InvalidCognitiveServicesSubdomain" === r.data && (g(), l({ code: i.ErrorCode.BadArgument, message: "The subdomain supplied is invalid." })) }; window.addEventListener("message", b), m = window.setTimeout((function () { g(), l({ code: i.ErrorCode.Timeout, message: "Page failed to load after timeout (" + u.timeout + " ms)" }) }), u.timeout), u.allowFullscreen && v.setAttribute("allowfullscreen", ""), v.style.cssText = "position: static; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0", u.useWebview && v.addEventListener("loadstop", (function () { v.contentWindow.postMessage(JSON.stringify({ messageType: "WebviewHost" }), "*") })); var y = (u.customDomain ? u.customDomain : "https://learningtools.onenote.com/learningtoolsapp/cognitive/") + "reader?exitCallback=ImmersiveReader-Exit&sdkPlatform=" + a + "&sdkVersion=" + o; u.hideExitButton && (y += "&hideExitButton=true"), u.uiLang && (y += "&omkt=" + u.uiLang), v.src = y, f.style.cssText = "position: fixed; width: 100vw; height: 100vh; left: 0; top: 0; border-width: 0; -webkit-perspective: 1px; z-index: " + u.uiZIndex + "; background: white; overflow: hidden", f.appendChild(v), document.body.appendChild(f), document.head.appendChild(p) } else l({ code: i.ErrorCode.BadArgument, message: "The subdomain supplied is invalid." }); else l({ code: i.ErrorCode.BadArgument, message: "Chunks must not be empty" }); else l({ code: i.ErrorCode.BadArgument, message: "Chunks must not be null" }); else l({ code: i.ErrorCode.BadArgument, message: "Content must not be null" }); else l({ code: i.ErrorCode.BadArgument, message: "Token must not be null" }) })) }, t.close = function () { window.postMessage("ImmersiveReader-Exit", "*") }, t.isValidSubdomain = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e.BadArgument = "BadArgument", e.Timeout = "Timeout", e.TokenExpired = "TokenExpired", e.Throttled = "Throttled" }(t.ErrorCode || (t.ErrorCode = {})) }]) }));